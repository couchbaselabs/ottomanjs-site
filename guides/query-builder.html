<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Query Builder | Ottoman.js</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Ottoman is a ODM built for Couchbase and Node.js. ">
    
    <link rel="preload" href="/assets/css/0.styles.4985b6e7.css" as="style"><link rel="preload" href="/assets/js/app.c190d55b.js" as="script"><link rel="preload" href="/assets/js/2.2b957f68.js" as="script"><link rel="preload" href="/assets/js/64.e786bb42.js" as="script"><link rel="prefetch" href="/assets/js/10.ff034a4b.js"><link rel="prefetch" href="/assets/js/11.3a710255.js"><link rel="prefetch" href="/assets/js/12.1ea510bc.js"><link rel="prefetch" href="/assets/js/13.41549cea.js"><link rel="prefetch" href="/assets/js/14.1270e0e9.js"><link rel="prefetch" href="/assets/js/15.b2972120.js"><link rel="prefetch" href="/assets/js/16.5eef8cb0.js"><link rel="prefetch" href="/assets/js/17.7f12643f.js"><link rel="prefetch" href="/assets/js/18.fbb0e09c.js"><link rel="prefetch" href="/assets/js/19.8df3beae.js"><link rel="prefetch" href="/assets/js/20.09d06b04.js"><link rel="prefetch" href="/assets/js/21.fd86dfd9.js"><link rel="prefetch" href="/assets/js/22.a7cfb167.js"><link rel="prefetch" href="/assets/js/23.d2a011cc.js"><link rel="prefetch" href="/assets/js/24.eb5cc168.js"><link rel="prefetch" href="/assets/js/25.13f95cdb.js"><link rel="prefetch" href="/assets/js/26.e8bc2b96.js"><link rel="prefetch" href="/assets/js/27.f2a37f8d.js"><link rel="prefetch" href="/assets/js/28.aef7d703.js"><link rel="prefetch" href="/assets/js/29.4f374797.js"><link rel="prefetch" href="/assets/js/3.8fd6c3d2.js"><link rel="prefetch" href="/assets/js/30.4d0cb06e.js"><link rel="prefetch" href="/assets/js/31.29e82c09.js"><link rel="prefetch" href="/assets/js/32.a306b619.js"><link rel="prefetch" href="/assets/js/33.c5b198d9.js"><link rel="prefetch" href="/assets/js/34.9ec92758.js"><link rel="prefetch" href="/assets/js/35.fa91b77b.js"><link rel="prefetch" href="/assets/js/36.ed624462.js"><link rel="prefetch" href="/assets/js/37.e09e8faa.js"><link rel="prefetch" href="/assets/js/38.4df6df33.js"><link rel="prefetch" href="/assets/js/39.0b2e5a35.js"><link rel="prefetch" href="/assets/js/4.e8b04f10.js"><link rel="prefetch" href="/assets/js/40.0f68b125.js"><link rel="prefetch" href="/assets/js/41.08ac51e2.js"><link rel="prefetch" href="/assets/js/42.ff2f4740.js"><link rel="prefetch" href="/assets/js/43.49c67c57.js"><link rel="prefetch" href="/assets/js/44.bdc60967.js"><link rel="prefetch" href="/assets/js/45.a8467803.js"><link rel="prefetch" href="/assets/js/46.88e767e3.js"><link rel="prefetch" href="/assets/js/47.bb000752.js"><link rel="prefetch" href="/assets/js/48.6634d3f1.js"><link rel="prefetch" href="/assets/js/49.67c6da60.js"><link rel="prefetch" href="/assets/js/5.909109eb.js"><link rel="prefetch" href="/assets/js/50.22b4c852.js"><link rel="prefetch" href="/assets/js/51.01e5e3ca.js"><link rel="prefetch" href="/assets/js/52.e011581f.js"><link rel="prefetch" href="/assets/js/53.ec429332.js"><link rel="prefetch" href="/assets/js/54.922d5276.js"><link rel="prefetch" href="/assets/js/55.1c7dfd41.js"><link rel="prefetch" href="/assets/js/56.1133e003.js"><link rel="prefetch" href="/assets/js/57.a279c13e.js"><link rel="prefetch" href="/assets/js/58.9ce1379f.js"><link rel="prefetch" href="/assets/js/59.055568cb.js"><link rel="prefetch" href="/assets/js/6.43d43fde.js"><link rel="prefetch" href="/assets/js/60.8fd14ee3.js"><link rel="prefetch" href="/assets/js/61.2146fab8.js"><link rel="prefetch" href="/assets/js/62.8f3c9110.js"><link rel="prefetch" href="/assets/js/63.c744b3b4.js"><link rel="prefetch" href="/assets/js/65.e92b29b8.js"><link rel="prefetch" href="/assets/js/66.ff478786.js"><link rel="prefetch" href="/assets/js/67.b59dd5b1.js"><link rel="prefetch" href="/assets/js/68.0f939d70.js"><link rel="prefetch" href="/assets/js/69.b6b14095.js"><link rel="prefetch" href="/assets/js/7.ac228f09.js"><link rel="prefetch" href="/assets/js/70.3829b662.js"><link rel="prefetch" href="/assets/js/71.09e4b7d4.js"><link rel="prefetch" href="/assets/js/72.8cff9df2.js"><link rel="prefetch" href="/assets/js/73.8c226bd6.js"><link rel="prefetch" href="/assets/js/74.2a0c359d.js"><link rel="prefetch" href="/assets/js/75.1a748f11.js"><link rel="prefetch" href="/assets/js/76.13c75e00.js"><link rel="prefetch" href="/assets/js/77.c659f561.js"><link rel="prefetch" href="/assets/js/78.35500649.js"><link rel="prefetch" href="/assets/js/79.4cf992e0.js"><link rel="prefetch" href="/assets/js/8.1c74a385.js"><link rel="prefetch" href="/assets/js/80.1f038312.js"><link rel="prefetch" href="/assets/js/81.881a716f.js"><link rel="prefetch" href="/assets/js/82.4d9583fa.js"><link rel="prefetch" href="/assets/js/83.204fd20c.js"><link rel="prefetch" href="/assets/js/84.eb69a75b.js"><link rel="prefetch" href="/assets/js/85.a46f0e32.js"><link rel="prefetch" href="/assets/js/86.b43983f2.js"><link rel="prefetch" href="/assets/js/87.d89e6ac4.js"><link rel="prefetch" href="/assets/js/88.b700dba0.js"><link rel="prefetch" href="/assets/js/89.186addfa.js"><link rel="prefetch" href="/assets/js/9.fe952048.js"><link rel="prefetch" href="/assets/js/90.f347dfe7.js"><link rel="prefetch" href="/assets/js/91.6fbb36c8.js"><link rel="prefetch" href="/assets/js/92.24c75922.js"><link rel="prefetch" href="/assets/js/93.6c4c8e33.js"><link rel="prefetch" href="/assets/js/94.892687a6.js"><link rel="prefetch" href="/assets/js/95.7c9620f8.js"><link rel="prefetch" href="/assets/js/96.34b8895a.js"><link rel="prefetch" href="/assets/js/97.5aef9b72.js"><link rel="prefetch" href="/assets/js/98.8150243a.js"><link rel="prefetch" href="/assets/js/99.ef1a1e42.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4985b6e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ottoman.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Query Builder</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/query-builder.html#using-the-query-builder" class="sidebar-link">Using the Query Builder.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters" class="sidebar-link">Build a Query by using parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-access-functions" class="sidebar-link">Build a query by using access functions</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters-and-function-parameters" class="sidebar-link">Build a query by using parameters and function parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#advanced-example-of-using-the-where-clause" class="sidebar-link">Advanced example of using the WHERE clause</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-select-clause-structure" class="sidebar-link">N1QL SELECT clause structure</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#n1ql-select-nested-clause-example" class="sidebar-link">N1QL SELECT nested clause example</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-where-clause-structure" class="sidebar-link">N1QL WHERE clause structure</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/query-builder.html#n1ql-join-clause-structure-currently-the-join-clause-is-only-supported-in-string-format" class="sidebar-link">N1QL JOIN clause structure (Currently the JOIN clause is only supported in string format.)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/query-builder.html#n1ql-group-by-clause-structure" class="sidebar-link">N1QL GROUP BY clause structure</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="query-builder"><a href="#query-builder" class="header-anchor">#</a> Query Builder</h1> <p><a href="/classes/query.html">Query Builder</a> is a flexible tool designed to create N1QL queries by specifying parameters and methods. Query Builder lets you: create queries of unlimited length and complexity without the need to know the syntax of N1QL Queries.</p> <h2 id="using-the-query-builder"><a href="#using-the-query-builder" class="header-anchor">#</a> Using the Query Builder.</h2> <p>There are 3 ways to use the Query Builder: by using parameters, by using access functions or by combining both.</p> <h3 id="build-a-query-by-using-parameters"><a href="#build-a-query-by-using-parameters" class="header-anchor">#</a> Build a Query by using parameters</h3> <p>To create queries by using parameters it is mandatory to define in the query constructor the <a href="/interfaces/iconditionexpr.html#hierarchy"><strong>parameters</strong></a> of the query and the <strong>name</strong> of the collection.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
  select<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      $count<span class="token operator">:</span> <span class="token punctuation">{</span>
        $field<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">let</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  where<span class="token operator">:</span> <span class="token punctuation">{</span>
    $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    $and<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">{</span> search_expr<span class="token operator">:</span> <span class="token string">'search'</span><span class="token punctuation">,</span> target_expr<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'10'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">{</span> search_expr<span class="token operator">:</span> <span class="token string">'search'</span><span class="token punctuation">,</span> target_expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'address'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  groupBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  letting<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  having<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'airlineR_8093'</span><span class="token punctuation">,</span> <span class="token string">'airlineR_8094'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>SELECT COUNT(type) AS odm FROM <code>travel-sample</code> USE KEYS [&quot;airlineR_8093&quot;,&quot;airlineR_8094&quot;] LET amount_val=10,size_val=20 WHERE ((price&gt;&quot;amount_val&quot; AND price IS NOT NULL) OR auto&gt;10 OR amount=10) AND ((price2&gt;1.99 AND price2 IS NOT NULL) AND ((price3&gt;1.99 AND price3 IS NOT NULL) OR id=&quot;20&quot;) AND (LOWER(name) = LOWER(&quot;John&quot;))) AND ANY search IN address SATISFIES address=&quot;10&quot; END AND search IN [&quot;address&quot;] GROUP BY type AS sch LETTING amount_v2=10,size_v2=20 HAVING type LIKE &quot;%hotel%&quot; ORDER BY type DESC LIMIT 10 OFFSET 1</p></blockquote> <h3 id="build-a-query-by-using-access-functions"><a href="#build-a-query-by-using-access-functions" class="header-anchor">#</a> Build a query by using access functions</h3> <p>Creating queries by using the access function is very similar to create them with parameters. The difference is that the parameters are not passed directly to the constructor, instead, they are passed using the different functions available in the Query Class.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    $count<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    $max<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token string">'amount'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> letExpr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_val'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> groupBy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> having <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">type</span><span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lettingExpr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'amount_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">'size_v2'</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orderBy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> limit <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> useExpr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'airlineR_8093'</span><span class="token punctuation">,</span> <span class="token string">'airlineR_8094'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'collection-name'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token keyword">let</span><span class="token punctuation">(</span>letExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>groupBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">letting</span><span class="token punctuation">(</span>lettingExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">having</span><span class="token punctuation">(</span>having<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">useKeys</span><span class="token punctuation">(</span>useExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>SELECT COUNT(type) AS odm,MAX(amount) FROM `travel-sample` USE KEYS ['airlineR_8093','airlineR_8094'] LET amount_val = 10,size_val = 20 WHERE ((price &gt; amount_val AND price IS NOT NULL) OR auto &gt; 10 OR amount = 10) AND ((price2 &gt; 1.99 AND price2 IS NOT NULL) AND ((price3 &gt; 1.99 AND price3 IS NOT NULL) OR id = '20')) GROUP BY type AS sch LETTING amount_v2=10,size_v2=20 HAVING type LIKE &quot;%hotel%&quot; ORDER BY type = 'DESC' LIMIT 10 OFFSET 1</p></blockquote> <h3 id="build-a-query-by-using-parameters-and-function-parameters"><a href="#build-a-query-by-using-parameters-and-function-parameters" class="header-anchor">#</a> Build a query by using parameters and function parameters</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>SELECT address FROM `travel-sample` WHERE price &gt; 5 LIMIT 10</p></blockquote> <h3 id="advanced-example-of-using-the-where-clause"><a href="#advanced-example-of-using-the-where-clause" class="header-anchor">#</a> Advanced example of using the WHERE clause</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token number">8000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $neq<span class="token operator">:</span> <span class="token number">9000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">7000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gte<span class="token operator">:</span> <span class="token number">6999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lt<span class="token operator">:</span> <span class="token number">5000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lte<span class="token operator">:</span> <span class="token number">4999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  $not<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%59%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token punctuation">{</span> $notLike<span class="token operator">:</span> <span class="token string">'Otto%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $btw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $notBtw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'St%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>SELECT * FROM <code>travel-sample</code> WHERE (address IS NULL OR free_breakfast IS MISSING OR free_breakfast IS NOT VALUED OR id=8000 OR id!=9000 OR id&gt;7000 OR id&gt;=6999 OR id&lt;5000 OR id&lt;=4999) AND (address IS NOT NULL AND address IS NOT MISSING AND address IS VALUED) AND NOT (address LIKE &quot;%59%&quot; AND name NOT LIKE &quot;Otto%&quot; AND (id BETWEEN 1 AND 2000 OR id NOT BETWEEN 2001 AND 8000) AND (LOWER(address) LIKE LOWER(&quot;St%&quot;))) LIMIT 20</p></blockquote> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Can also use <code>ignoreCase</code> as part of the <code>build</code> method, this will always prioritize the <code>$ignoreCase</code> value defined in clause</p> <div class="language-ts extra-class"><pre class="language-ts"><code>  <span class="token keyword">const</span> expr_where <span class="token operator">=</span> <span class="token punctuation">{</span>
   $or<span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%57-59%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// ignoreCase will not be applied</span>
     <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">//  ignoreCase will be applied</span>
   <span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * Can also use:
 * const expr_where = {
 *   $or: [
 *     ...
 *     { name:'John' } //  ignoreCase will be applied
 *   ],
 * };
 * 
 */</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>expr_where<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ignore case is enabled for where clause elements</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><p>Would have as output:</p> <blockquote><p>SELECT address FROM <code>travel-sample</code> WHERE (address LIKE &quot;%57-59%&quot; OR free_breakfast=true OR <code>(LOWER(name) = LOWER(&quot;John&quot;))</code>)</p></blockquote></div> <h2 id="n1ql-select-clause-structure"><a href="#n1ql-select-clause-structure" class="header-anchor">#</a> N1QL SELECT clause structure</h2> <p>See definition <a href="/classes/query.html#select">here</a></p> <p>The syntax of a SELECT clause in n1ql is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/select-syntax.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Available Result Expression Arguments:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$all</td> <td>ALL</td></tr> <tr><td>$distinct</td> <td>DISTINCT</td></tr> <tr><td>$raw</td> <td>RAW</td></tr> <tr><td>$element</td> <td>ELEMENT</td></tr> <tr><td>$value</td> <td>VALUE</td></tr></tbody></table> <p>Available Aggregation Functions:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$arrayAgg</td> <td>ARRAY_AGG</td></tr> <tr><td>$avg</td> <td>AVG</td></tr> <tr><td>$mean</td> <td>MEAN</td></tr> <tr><td>$count</td> <td>COUNT</td></tr> <tr><td>$countn</td> <td>COUNTN</td></tr> <tr><td>$max</td> <td>MAX</td></tr> <tr><td>$median</td> <td>MEDIAN</td></tr> <tr><td>$min</td> <td>MIN</td></tr> <tr><td>$stddev</td> <td>STDDEV</td></tr> <tr><td>$stddevPop</td> <td>STDDEV_POP</td></tr> <tr><td>$stddevSamp</td> <td>STDDEV_SAMP</td></tr> <tr><td>$sum</td> <td>SUM</td></tr> <tr><td>$variance</td> <td>VARIANCE</td></tr> <tr><td>$variancePop</td> <td>VARIANCE_POP</td></tr> <tr><td>$varianceSamp</td> <td>VARIANCE_SAMP</td></tr> <tr><td>$varPop</td> <td>VAR_SAMP</td></tr> <tr><td>$varSamp</td> <td>VAR_SAMP</td></tr></tbody></table> <h3 id="n1ql-select-nested-clause-example"><a href="#n1ql-select-nested-clause-example" class="header-anchor">#</a> N1QL SELECT nested clause example</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'{&quot;latLon&quot;: {geo.lat, geo.lon} }'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'geo'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'a.type'</span><span class="token operator">:</span> <span class="token string">'hotel'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>'SELECT {&quot;latLon&quot;: {geo.lat, geo.lon} } AS geo FROM <code>travel-sample</code> a WHERE a.type=&quot;hotel&quot;'</p></blockquote> <h2 id="n1ql-where-clause-structure"><a href="#n1ql-where-clause-structure" class="header-anchor">#</a> N1QL WHERE clause structure</h2> <p>See definition <a href="/classes/query.html#where">here</a></p> <p>The syntax of a WHERE clause in n1ql is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/where.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Available Comparison Operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$isNull</td> <td>IS NULL</td></tr> <tr><td>$isNotNull</td> <td>IS NOT NULL</td></tr> <tr><td>$isMissing</td> <td>IS MISSING</td></tr> <tr><td>$isNotMissing</td> <td>IS NOT MISSING</td></tr> <tr><td>$isValued</td> <td>IS VALUED</td></tr> <tr><td>$isNotValued</td> <td>IS NOT VALUED</td></tr> <tr><td>$eq</td> <td>=</td></tr> <tr><td>$neq</td> <td>!=</td></tr> <tr><td>$gt</td> <td>&gt;</td></tr> <tr><td>$gte</td> <td>&gt;=</td></tr> <tr><td>$lt</td> <td>&lt;</td></tr> <tr><td>$lte</td> <td>&lt;=</td></tr> <tr><td>$like</td> <td>LIKE</td></tr> <tr><td>$notLike</td> <td>NOT LIKE</td></tr> <tr><td>$btw</td> <td>BETWEEN</td></tr> <tr><td>$notBtw</td> <td>NOT BETWEEN</td></tr></tbody></table> <p>Available Logical operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$and</td> <td>AND</td></tr> <tr><td>$or</td> <td>OR</td></tr> <tr><td>$not</td> <td>NOT</td></tr></tbody></table> <p>Available COLLECTION operators:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$any</td> <td>ANY</td></tr> <tr><td>$every</td> <td>EVERY</td></tr> <tr><td>$in</td> <td>IN</td></tr> <tr><td>$within</td> <td>WITHIN</td></tr> <tr><td>$satisfies</td> <td>SATISFIES</td></tr></tbody></table> <p>Available String Modifiers:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$ignoreCase</td> <td>Boolean</td></tr></tbody></table> <h2 id="n1ql-join-clause-structure-currently-the-join-clause-is-only-supported-in-string-format"><a href="#n1ql-join-clause-structure-currently-the-join-clause-is-only-supported-in-string-format" class="header-anchor">#</a> N1QL JOIN clause structure (Currently the JOIN clause is only supported in string format.)</h2> <p>See definition <a href="/classes/query.html#plainJoin">here</a></p> <p>The syntax of a JOIN clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/join.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="n1ql-group-by-clause-structure"><a href="#n1ql-group-by-clause-structure" class="header-anchor">#</a> N1QL GROUP BY clause structure</h2> <p>See definition <a href="/classes/query.html#groupby">here</a></p> <p>The syntax of a GROUP BY clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/groupby.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c190d55b.js" defer></script><script src="/assets/js/2.2b957f68.js" defer></script><script src="/assets/js/64.e786bb42.js" defer></script>
  </body>
</html>
